<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üß† Session Example</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    body { font-family: Arial; text-align: center; background: #e3f2fd; padding-top: 70px; transition: opacity 1s; }
    .bar { width: 300px; height: 12px; background: #bbdefb; border-radius: 6px; margin: 15px auto; overflow: hidden; }
    .fill { height: 100%; background: #0d6efd; width: 100%; transition: width 1s linear; }
  </style>
</head>
<body>
  {% if session_user %}
    <h2>üß† Session Active: <b>{{ session_user }}</b></h2>
    <p>Session expires in <span id="time">5</span> seconds...</p>
    <div class="bar"><div class="fill" id="bar"></div></div>

    <script>
      let t = 5;
      const bar = document.getElementById("bar");
      const time = document.getElementById("time");
      const countdown = setInterval(() => {
        t--;
        bar.style.width = (t / 5 * 100) + "%";
        time.textContent = t;
        if (t <= 0) {
          clearInterval(countdown);
          Swal.fire({
            icon: 'info',
            title: 'üß† Session Expired',
            text: 'Your session has ended.',
            background: '#e3f2fd',
            color: '#0d47a1',
            showConfirmButton: false,
            timer: 1800
          }).then(() => {
            document.body.style.opacity = 0;
            setTimeout(() => window.location.href = "{% url 'cache_page' %}", 800);
          });
        }
      }, 1000);
    </script>
  {% else %}
    <h3>‚ùå Session expired. Go back.</h3>
  {% endif %}
</body>
</html>
